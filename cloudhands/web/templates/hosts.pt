<html metal:use-macro="load: base.pt" lang="en">
<nav metal:fill-slot="nav" class="pure-menu pure-menu-open">
    <ul>
    <li class="pure-menu-heading" ><a href="/">JASMIN</a></li>
    <li><a href="#">Account</a></li>
    <li><a href="#">JVO</a></li>
    <li class="pure-menu-selected" ><a href="/hosts">VMs</a></li>
    </ul>
</nav>
<div metal:fill-slot="summary">
<section id="items">
<h1>Virtual machines</h1>
<table class="pure-table pure-table-horizontal">
<thead>
<tr><th>Host</th><th>Status</th><th>IP</th><th>Actions</th></tr>
</thead>
<tbody>
<tr
tal:repeat="(itemId, item) items.items()"
tal:attributes="
id itemId
"><td>${item['name']}</td>
<td tal:content="python: 'running' if 'up' in [s.name for s in item.states] else 'stopped'"></td>
<td tal:content="python: item.data['ips'][0] if item.data['ips'] else None"></td>
<td><a class="pure-button" tal:repeat="link item['_links']" tal:attributes=
"href python: '/'.join(getattr([i for i in item['_links'] if i.rel == 'self'][0], v) for v in ('typ', 'ref'));
">
<i tal:condition="link.action == 'settings'" class="fa fa-cog"></i>
${link.action.capitalize()}</a></td>
</tr>
</tbody>
</table>
</section>
</div>
<section metal:fill-slot="detail" id="options">
<ul>
<li tal:repeat="option options.values()">
<form class="pure-form"
tal:define="link option['_links'][0]"
tal:attributes="
name string:${link.rel}_${link.method};
method link.method;
action string:${link.typ}/${link.ref};
id string:option_${repeat['option'].index}">
<fieldset>
<legend>${link.name}</legend>
<div tal:omit-tag="" tal:repeat="field link.parameters" >
<label tal:attributes="for field.name">
<input tal:attributes="
id field.name;
value field.name;
required python:'required' if field.required else None" />
</label>
</div>
<button type="submit" class="pure-button pure-button-primary">${link.action}</button>
</fieldset>
</form>
</li>
</ul>
</section>
</html>
